{
  "version": "2.1",
  "description": "Comprehensive AdBlock/AdGuard syntax database covering AdBlock basic rules, AdGuard extended rules, DNS filtering, and cosmetic filtering rules. Designed for accurate rule parsing and deduplication.",
  "last_updated": "2025-08-26",
  "syntax_patterns": {
    "comment": "^[!#]",
    "exception_rule": "^@@",
    "domain_rule": "^\\\\|\\\\|([^\\\\^]+)\\\\^",
    "url_rule": "^\\\\|([^\\\\|]+)\\\\|",
    "regex_rule": "^/(.*)/$",
    "hosts_rule": "^\\\\d+\\\\.\\\\d+\\\\.\\\\d+\\\\.\\\\d+\\\\s+",
    "element_hiding_basic": "##",
    "element_hiding_exception": "#@#",
    "extended_css": "#?#",
    "adguard_scriptlet": "#%#",
    "adguard_dns_rule": "^\\\\|\\\\|[^\\\\^]*\\\\^\\\\$dnstype=",
    "adguard_stealth_rule": "^\\\\|\\\\|[^\\\\^]*\\\\^\\\\$stealth",
    "adguard_redirect_rule": "\\\\$redirect=",
    "adguard_removeparam_rule": "\\\\$removeparam=",
    "adguard_csp_rule": "\\\\$csp=",
    "adguard_replace_rule": "\\\\$replace=",
    "adguard_cookie_rule": "\\\\$cookie=",
    "adguard_generichide": "\\\\$generichide",
    "adguard_specific_domain": "^[a-zA-Z0-9][a-zA-Z0-9.-]*[a-zA-Z0-9]$"
  },
  "rule_types": {
    "comment": "invalid",
    "exception_rule": "allow",
    "domain_rule": "block",
    "url_rule": "block",
    "regex_rule": "block",
    "hosts_rule": "block",
    "element_hiding_basic": "cosmetic",
    "element_hiding_exception": "cosmetic_allow",
    "extended_css": "cosmetic_extended",
    "adguard_scriptlet": "scriptlet",
    "adguard_dns_rule": "block",
    "adguard_stealth_rule": "block",
    "adguard_redirect_rule": "block",
    "adguard_removeparam_rule": "block",
    "adguard_csp_rule": "block",
    "adguard_replace_rule": "block",
    "adguard_cookie_rule": "block",
    "adguard_generichide": "cosmetic",
    "adguard_specific_domain": "block"
  },
  "modifiers": {
    "domain": "domain=([^\\s,]+)",
    "third-party": "third-party",
    "first-party": "first-party",
    "script": "script",
    "image": "image",
    "stylesheet": "stylesheet",
    "object": "object",
    "xmlhttprequest": "xmlhttprequest",
    "subdocument": "subdocument",
    "document": "document",
    "elemhide": "elemhide",
    "other": "other",
    "match-case": "match-case",
    "collapse": "collapse",
    "donottrack": "donottrack",
    "websocket": "websocket",
    "webrtc": "webrtc",
    "dnstype": "dnstype=([^\\s,]+)",
    "dnsrewrite": "dnsrewrite=([^\\s,]+)",
    "important": "important",
    "badfilter": "badfilter",
    "empty": "empty",
    "mp4": "mp4",
    "redirect": "redirect=([^\\s,]+)",
    "redirect-rule": "redirect-rule=([^\\s,]+)",
    "removeparam": "removeparam=([^\\s,]+)",
    "csp": "csp=([^\\s,]+)",
    "replace": "replace=([^\\s,]+)",
    "cookie": "cookie=([^\\s,]+)",
    "generichide": "generichide",
    "specifichide": "specifichide",
    "stealth": "stealth",
    "client": "client=([^\\s,]+)",
    "denyallow": "denyallow=([^\\s,]+)",
    "app": "app=([^\\s,]+)",
    "network": "network=([^\\s,]+)",
    "method": "method=([^\\s,]+)"
  },
  "common_patterns": {
    "ad_keywords": ["ad", "ads", "advert", "advertising", "adv", "banner", "promo", "popup", "track", "tracking", "analytics", "affiliate", "doubleclick", "googlead", "adsense"],
    "element_selectors": [".ad-", "#ad-", "[class*=\"ad\"]", "[id*=\"ad\"]", ".banner", ".popup", ".modal", ".overlay", ".newsletter", ".subscribe", ".cookie", ".gdpr"],
    "known_trackers": ["google-analytics", "googletagmanager", "facebook.net", "scorecardresearch", "hotjar", "amplitude", "mixpanel", "matomo", "piwik"]
  },
  "normalization_rules": {
    "domain_to_lowercase": true,
    "sort_modifiers": true,
    "remove_redundant_wildcards": true,
    "standardize_protocols": true,
    "canonicalize_domains": true
  },
  "validation_rules": {
    "max_rule_length": 2000,
    "min_rule_length": 3,
    "valid_domain_chars": "a-zA-Z0-9.-",
    "valid_modifier_combinations": {
      "document": ["domain", "important", "badfilter"],
      "elemhide": ["domain", "generichide", "specifichide"],
      "redirect": ["domain", "important", "script", "image"],
      "removeparam": ["domain", "important", "third-party"]
    }
  }
}